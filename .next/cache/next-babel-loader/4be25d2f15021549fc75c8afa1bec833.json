{"ast":null,"code":"var __jsx = React.createElement;\nimport Router from \"next/router\";\nimport React, { Component } from \"react\";\nimport { redirectToLogin } from \"./redirect\";\nimport nookies from \"nookies\";\nimport Cookies from \"js-cookie\";\nexport const TOKEN_STORAGE_NAME = \"app.authToken\";\nexport function login(token) {\n  nookies.set(null, TOKEN_STORAGE_NAME, token, {\n    maxAge: 7 * 24 * 60 * 60,\n    path: \"/\"\n  });\n  Router.push(\"/\");\n}\nexport function logout() {\n  Cookies.remove(TOKEN_STORAGE_NAME, {\n    path: \"/\"\n  }); // to support logging out from all windows\n\n  window.localStorage.setItem(\"logout\", Date.now().toString());\n}\nexport function withAuth(WrappedComponent) {\n  return class AuthWrapper extends Component {\n    static async getInitialProps(ctx, props) {\n      const {\n        auth\n      } = props;\n\n      if (!auth || auth && auth.isExpired) {\n        redirectToLogin(ctx.res);\n      }\n\n      const initialProps = {\n        auth\n      };\n\n      if (WrappedComponent.getInitialProps) {\n        return WrappedComponent.getInitialProps(ctx, initialProps);\n      }\n\n      return initialProps;\n    }\n\n    render() {\n      return __jsx(WrappedComponent, this.props);\n    }\n\n  };\n}","map":null,"metadata":{},"sourceType":"module"}